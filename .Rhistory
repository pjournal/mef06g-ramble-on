#income_n1$Tourism_Income_in_ThousandDollars = ifelse(is.na(income_n1$Tourism_Income_in_ThousandDollars), ave(income_n1$Tourism_Income_in_ThousandDollars, FUN = function(x) mean(x, na.rm = TRUE)), income_n1$Tourism_Income_in_ThousandDollars)# deneme amaçlı 2022 annual değeri doldurma fonksiyonu ?
income_n1 <- filter(income_nights, Quarter %in% c("Anual"))
ggplot(income_n1, aes(x = Year, y = Number_of_Departing_Visitors)) + geom_bar(stat = "identity" , fill = )
library(readxl)
income_nights <- read_excel("term_project/income_nights.xlsx")
income_months <- read_excel("term_project/income_months.xlsx")
#income_n1$Tourism_Income_in_ThousandDollars = ifelse(is.na(income_n1$Tourism_Income_in_ThousandDollars), ave(income_n1$Tourism_Income_in_ThousandDollars, FUN = function(x) mean(x, na.rm = TRUE)), income_n1$Tourism_Income_in_ThousandDollars)# deneme amaçlı 2022 annual değeri doldurma fonksiyonu ?
income_n1 <- filter(income_nights, Quarter %in% c("Anual"))
ggplot(income_n1, aes(x = Year, y = Number_of_Departing_Visitors)) + geom_bar(stat = "identity" , fill = )
library(readxl)
income_nights <- read_excel("term_project/income_nights.xlsx")
income_months <- read_excel("term_project/income_months.xlsx")
#income_n1$Tourism_Income_in_ThousandDollars = ifelse(is.na(income_n1$Tourism_Income_in_ThousandDollars), ave(income_n1$Tourism_Income_in_ThousandDollars, FUN = function(x) mean(x, na.rm = TRUE)), income_n1$Tourism_Income_in_ThousandDollars)# deneme amaçlı 2022 annual değeri doldurma fonksiyonu ?
income_n1 <- filter(income_nights, Quarter %in% c("Anual"))
ggplot(income_n1, aes(x = Year, y = Number_of_Departing_Visitors)) + geom_bar(stat = "identity" )
national <- read_excel("term_project/depart_by_residence.xlsx")
national_melt <- melt = (national, id ="Nationality")
national <- read_excel("term_project/depart_by_residence.xlsx")
national_melt <- melt = (national, id =("Nationality"))
national <- read_excel("term_project/depart_by_residence.xlsx")
national_melt <- melt = (data, id =("Nationality"))
national_melt <- melt = (national, id =("Nationality"))
national_melt <- melt = (national, id =c("Nationality"))
national <- read_excel("term_project/depart_by_residence.xlsx")
national_melt <- melt = (national, id ="Nationality")
national_melt <- melt(national, id ="Nationality")
national_melt <- melt(national, id ="Nationality")
national <- read_excel("term_project/depart_by_residence.xlsx")
melt_national <- melt(national, id ="Nationality")
residence <- read_excel("term_project/depart_by_residence.xlsx")
national <- melt(residence, id ="Nationality")
residence <- read_excel("term_project/depart_by_residence.xlsx")
national <- melt(residence, id =c("Nationality"))
residence <- read_excel("term_project/depart_by_residence.xlsx")
national <- melt(residence, id =c("Nationality"))
residence <- read_excel("term_project/depart_by_residence.xlsx")
national <- melt(residence, id =c("Nationality"))
residence <- read_excel("term_project/depart_by_residence.xlsx")
##national <- melt(residence, id =c("Nationality"))#
ggplot
residence <- read_excel("term_project/depart_by_residence.xlsx")
##national <- melt(residence, id =c("Nationality"))#
ggplot(residence, aes(x = 2020, y= Nationality, fill = Nationality)) + geom_bar(stat = "identity", position = "dodge")
residence <- read_excel("term_project/depart_by_residence.xlsx")
##national <- melt(residence, id =c("Nationality"))#
ggplot(residence, aes(x = Nationality, y= 2020, fill = Nationality)) + geom_bar(stat = "identity", position = "dodge")
residence <- read_excel("term_project/depart_by_residence.xlsx")
##national <- melt(residence, id =c("Nationality"))#
ggplot(residence, aes(x = Nationality, y= 2020, fill = Nationality)) + geom_bar(stat = "identity")
ggplot(income_months, aes(x = Months, y = Number_of_Visitors_2020)) + geom_bar(stat = "identity", fill = months)
residence <- read_excel("term_project/depart_by_residence.xlsx")
##national <- melt(residence, id =c("Nationality"))#
library(readxl)
income_nights <- read_excel("term_project/income_nights.xlsx")
income_months <- read_excel("term_project/income_months.xlsx")
#income_n1$Tourism_Income_in_ThousandDollars = ifelse(is.na(income_n1$Tourism_Income_in_ThousandDollars), ave(income_n1$Tourism_Income_in_ThousandDollars, FUN = function(x) mean(x, na.rm = TRUE)), income_n1$Tourism_Income_in_ThousandDollars)# deneme amaçlı 2022 annual değeri doldurma fonksiyonu ?
income_n1 <- filter(income_nights, Quarter %in% c("Anual"))
ggplot(income_n1, aes(x = Year, y = Number_of_Departing_Visitors, fill=Year)) + geom_bar(stat = "identity" )
ggplot(income_months, aes(x = Months, y = Number_of_Visitors_2020, fill=Months)) + geom_bar(stat = "identity")
ggplot(income_months, aes(x = Months, y = Number_of_Visitors_2021, fill=Months)) + geom_bar(stat = "identity")
ggplot(income_n1, aes(Year)) +
geom_line(aes(y = ALL_Average_expenditure_per_capita_in_Dollars, colour = "ALL_Average_expenditure_per_capita_in_Dollars")) +
geom_line(aes(y = ALL_Average_number_of_overnights, colour = "ALL_Average_number_of_overnights"))
ggplot(income_n1, aes(x= ALL_Average_number_of_overnights, y =Year) + geom_dotplot()
ggplot(income_n1, aes(x= ALL_Average_number_of_overnights, y =Year)
library(reshape2)
residence <- read_excel("term_project/depart_by_residence.xlsx")
national <- melt(residence, id ="Nationality")
residence <- read_excel("term_project/depart_by_residence.xlsx")
national <- melt(residence, id ="Nationality")
residence <- read_excel("term_project/depart_by_residence.xlsx")
#national <- melt(residence, id ="Nationality")
residence <- read_excel("term_project/depart_by_residence.xlsx")
national <- melt(residence, id ="Nationality")
reasons_1 <- filter(reasons_to_come, Quarter %in% "Annual")
ggplot(reasons_to_come, aes(x = Year, y= ALL_Total, fill = Quarter)) + geom_bar(stat = "identity", position = "dodge")
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
library(reshape2)
library(readxl)
income_nights <- read_excel("term_project/income_nights.xlsx")
income_months <- read_excel("term_project/income_months.xlsx")
#income_n1$Tourism_Income_in_ThousandDollars = ifelse(is.na(income_n1$Tourism_Income_in_ThousandDollars), ave(income_n1$Tourism_Income_in_ThousandDollars, FUN = function(x) mean(x, na.rm = TRUE)), income_n1$Tourism_Income_in_ThousandDollars)# deneme amaçlı 2022 annual değeri doldurma fonksiyonu ?
income_n1 <- filter(income_nights, Quarter %in% c("Anual"))
ggplot(income_n1, aes(x = Year, y = Number_of_Departing_Visitors, fill=Year)) + geom_bar(stat = "identity" )
ggplot(income_months, aes(x = Months, y = Number_of_Visitors_2020, fill=Months)) + geom_bar(stat = "identity")
ggplot(income_months, aes(x = Months, y = Number_of_Visitors_2021, fill=Months)) + geom_bar(stat = "identity")
ggplot(income_n1, aes(Year)) +
geom_line(aes(y = Tourism_expenditure_in_ThousandDollars, colour = "Tourism expenditure in ThousandDollars")) +
geom_line(aes(y = Tourism_Income_in_ThousandDollars, colour = "Tourism Income in ThousandDollars"))
##ggplot(income_n1, aes(x= ALL_Average_number_of_overnights, y =Year) +
residence <- read_excel("term_project/depart_by_residence.xlsx")
national <- melt(residence, id ="Nationality")
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
library(reshape2)
library(readxl)
income_nights <- read_excel("term_project/income_nights.xlsx")
income_months <- read_excel("term_project/income_months.xlsx")
#income_n1$Tourism_Income_in_ThousandDollars = ifelse(is.na(income_n1$Tourism_Income_in_ThousandDollars), ave(income_n1$Tourism_Income_in_ThousandDollars, FUN = function(x) mean(x, na.rm = TRUE)), income_n1$Tourism_Income_in_ThousandDollars)# deneme amaçlı 2022 annual değeri doldurma fonksiyonu ?
income_n1 <- filter(income_nights, Quarter %in% c("Anual"))
ggplot(income_n1, aes(x = Year, y = Number_of_Departing_Visitors, fill=Year)) + geom_bar(stat = "identity" )
ggplot(income_months, aes(x = Months, y = Number_of_Visitors_2020, fill=Months)) + geom_bar(stat = "identity")
ggplot(income_months, aes(x = Months, y = Number_of_Visitors_2021, fill=Months)) + geom_bar(stat = "identity")
ggplot(income_n1, aes(Year)) +
geom_line(aes(y = Tourism_expenditure_in_ThousandDollars, colour = "Tourism expenditure in ThousandDollars")) +
geom_line(aes(y = Tourism_Income_in_ThousandDollars, colour = "Tourism Income in ThousandDollars"))
##ggplot(income_n1, aes(x= ALL_Average_number_of_overnights, y =Year) +
residence <- read_excel("term_project/depart_by_residence.xlsx")
national <- melt(residence, id ="Nationality")
income_m1 <- filter(income_months, Months %in% c("January", "February", "Mqrch", "April", "May", "June", "July", "August","September","October","November","December"))
ggplot(income_m1, aes(x = Months, y = Number_of_Visitors_2020, fill=Months)) + geom_bar(stat = "identity")
ggplot(income_m1, aes(x = Months, y = Number_of_Visitors_2021, fill=Months)) + geom_bar(stat = "identity")
library(plotly)
install.packages("plotly")
install.packages("plotly")
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
library(reshape2)
library(plotly)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
library(reshape2)
library(plotly)
#residence <- read_excel("term_project/depart_by_residence.xlsx")
#national <- melt(residence, id ="Nationality")
residence <- read_excel("term_project/depart_by_residence.xlsx")
colnames(residence) <- c('Nationality', 'Year_2012', 'Year_2013', 'Year_2014', 'Year_2015', 'Year_2015', 'Year_2016', 'Year_2017', 'Year_2018', 'Year_2019',  'Year_2020', 'Year_2021')
residence <- read_excel("term_project/depart_by_residence.xlsx")
colnames(residence) <- c('Nationality', 'Year_2012', 'Year_2013', 'Year_2014', 'Year_2015', 'Year_2015', 'Year_2016', 'Year_2017', 'Year_2018', 'Year_2019',  'Year_2020', 'Year_2021')
str(residence)
residence <- read_excel("term_project/depart_by_residence.xlsx")
colnames(residence) <- c('Nationality', 'Year_2012', 'Year_2013', 'Year_2014', 'Year_2015', 'Year_2015', 'Year_2016', 'Year_2017', 'Year_2018', 'Year_2019',  'Year_2020', 'Year_2021')
ggplot(residence, aes(x="", y=Year_2021, fill = Nationality)) + geom_bar(stat = "identity", width = 1) + coord_polar("y", start=0)
residence <- read_excel("term_project/depart_by_residence.xlsx")
colnames(residence) <- c('Nationality', 'Year_2012', 'Year_2013', 'Year_2014', 'Year_2015', 'Year_2015', 'Year_2016', 'Year_2017', 'Year_2018', 'Year_2019',  'Year_2020', 'Year_2021')
ggplot(residence, aes(x="", y=Year_2021, fill = Nationality)) + geom_bar(stat = "identity", width = 1)
residence <- read_excel("term_project/depart_by_residence.xlsx")
colnames(residence) <- c('Nationality', 'Year_2012', 'Year_2013', 'Year_2014', 'Year_2015', 'Year_2015', 'Year_2016', 'Year_2017', 'Year_2018', 'Year_2019',  'Year_2020', 'Year_2021')
ggplot(residence, aes(x="", y=Year_2021, fill = Nationality)) + geom_bar(stat = "identity")
residence <- read_excel("term_project/depart_by_residence.xlsx")
colnames(residence) <- c('Nationality', 'Year_2012', 'Year_2013', 'Year_2014', 'Year_2015', 'Year_2015', 'Year_2016', 'Year_2017', 'Year_2018', 'Year_2019',  'Year_2020', 'Year_2021')
ggplot(residence, aes(x="", y=Year_2021, fill = Nationality)) + geom_bar(stat = "identity")
residence <- read_excel("term_project/depart_by_residence.xlsx")
colnames(residence) <- c('Nationality', 'Year_2012', 'Year_2013', 'Year_2014', 'Year_2015', 'Year_2015', 'Year_2016', 'Year_2017', 'Year_2018', 'Year_2019',  'Year_2020', 'Year_2021')
ggplot(residence, aes(x=" ", y=Year_2021, fill = Nationality)) + geom_bar(stat = "identity")
reasons_to_come <- read_excel("term_project/purposes.xlsx")
reasons_1 <- filter(reasons_to_come, Quarter %in% "Annual")
ggplot(reasons_1, aes(Year)) +
geom_line(aes(y = ALL_Total, colour = "Total Touristic Activities")) +
geom_line(aes(y = ALL_Health_or_medical_reasons, colour = "Health or Medical Reasons"))
residence <- read_excel("term_project/depart_by_residence.xlsx")
#colnames(residence) <- c('Nationality', 'Year_2012', 'Year_2013', 'Year_2014', 'Year_2015', 'Year_2015', 'Year_2016', 'Year_2017', 'Year_2018', 'Year_2019',  'Year_2020', 'Year_2021')
#ggplot(residence, aes(x=" ", y=Year_2020, fill = Nationality)) + geom_bar(stat = "identity")
residence_new <- do.call(rbind, residence)
residence_new
residence_new
residence <- read_excel("term_project/depart_by_residence.xlsx")
#colnames(residence) <- c('Nationality', 'Year_2012', 'Year_2013', 'Year_2014', 'Year_2015', 'Year_2015', 'Year_2016', 'Year_2017', 'Year_2018', 'Year_2019',  'Year_2020', 'Year_2021')
#ggplot(residence, aes(x=" ", y=Year_2020, fill = Nationality)) + geom_bar(stat = "identity")
residence_new <- melt(residence, id = "Nationality")
library(reshape2)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
library(reshape2)
library(plotly)
residence <- read_excel("term_project/depart_by_residence.xlsx")
#colnames(residence) <- c('Nationality', 'Year_2012', 'Year_2013', 'Year_2014', 'Year_2015', 'Year_2015', 'Year_2016', 'Year_2017', 'Year_2018', 'Year_2019',  'Year_2020', 'Year_2021')
#ggplot(residence, aes(x=" ", y=Year_2020, fill = Nationality)) + geom_bar(stat = "identity")
residence_new <- melt(residence, id = "Nationality")
reasons_1
ggplot(reasons_1, aes(x= Year, y= Quarter, fill = Quarter))+geom_boxplot()
ggplot(reasons_to_come, aes(x= Year, y= Quarter, fill = Quarter))+geom_boxplot()
ggplot(reasons_to_come, aes(x= Year, y= Quarter, fill = All_Total))+geom_boxplot()
ggplot(reasons_to_come, aes(x= Year, y= Quarter, fill = ALL_Total))+geom_boxplot()
ggplot(reasons_to_come, aes(x= Year, y= ALL_Total, fill = Quarter))+geom_boxplot()
ggplot(reasons_to_come, aes(x= Year, y= ALL_Total, fill = Quarter))+geom_boxplot()
reasons_1 <- filter(reasons_to_come, Quarter %in% "Annual")
ggplot(reasons_1, aes(x= Year, y= ALL_Total, fill = Quarter))+geom_boxplot()
reasons_to_come <- read_excel("term_project/purposes.xlsx")
reasons_quarter <- filter(reasons_to_come, Quarter %in% "I" , "II", "III", "IV")
reasons_to_come <- read_excel("term_project/purposes.xlsx")
reasons_quarter <- filter(reasons_to_come, Quarter %in% "I", "II", "III", "IV")
reasons_to_come <- read_excel("term_project/purposes.xlsx")
reasons_quarter <- filter(reasons_to_come, Quarter %in% c("I", "II", "III", "IV"))
ggplot(reasons_quarter, aes(x= Year, y= ALL_Total, fill = Quarter))+geom_boxplot()
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
library(reshape2)
library(plotly)
library(gapminder)
install.packages("gapminder")
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
library(reshape2)
library(plotly)
library(gapminder)
p <- gapminder %>% filter(Year==2020) %>%
ggplot(aes(Tourism_expenditure_in_ThousandDollars, Tourism_Income_in_ThousandDollars, size = pop)) +
geom_point() +
theme_bw()
income_m1 <- filter(income_months, Months %in% c("January", "February", "March", "April", "May", "June", "July", "August","September","October","November","December"))
ggplot(income_m1, aes(x = Months, y = Number_of_Visitors_2020, fill=Months)) + geom_bar(stat = "identity")
ggplot(income_m1, aes(x = Months, y = Number_of_Visitors_2021, fill=Months)) + geom_bar(stat = "identity" )
p <- gapminder %>% filter(Year==2020) %>%
ggplot(income_n1, aes(Tourism_expenditure_in_ThousandDollars, Tourism_Income_in_ThousandDollars, size = pop)) +
geom_point() +
theme_bw()
p <- gapminder %>%
ggplot(income_n1, aes(Tourism_expenditure_in_ThousandDollars, Tourism_Income_in_ThousandDollars, size = pop)) +
geom_point() +
theme_bw()
p <- gapminder %>%
ggplot(aes(Tourism_expenditure_in_ThousandDollars, Tourism_Income_in_ThousandDollars, size = pop)) +
geom_point() +
theme_bw()
ggplotly(p)
p <- income_n1 %>%
ggplot(aes(Tourism_expenditure_in_ThousandDollars, Tourism_Income_in_ThousandDollars, size = pop)) +
geom_point() +
theme_bw()
ggplotly(p)
p <- income_n1 %>%
ggplot(aes(Tourism_expenditure_in_ThousandDollars, Tourism_Income_in_ThousandDollars, size = Year)) +
geom_point() +
theme_bw()
ggplotly(p)
p <- income_n1 %>%
ggplot(aes(Tourism_expenditure_in_ThousandDollars, Tourism_Income_in_ThousandDollars, size = Year, color = Year)) +
geom_point() +
theme_bw()
ggplotly(p)
ggplot(reasons_1, aes(Year)) +
geom_line(aes(y = ALL_Total, colour = "Total Touristic Activities")) +
geom_line(aes(y = ALL_Travel_entertainment_sportive_or_cultural_activities, colour = "Cultural Activites"))
library(readxl)
library(knitr)
library(dplyr)
library(tidyr)
# install.packages("writexl")
library(writexl)
dep <- readxl::read_excel("term_project/Number of Departing Visitors by Country of Residence.xls", skip = 4)
glimpse(dep)
dep <- head(dep, - 15)
dep <- dep %>%
separate(Nationality, c(NA,"Nationality")," - ")
names(dep)[names(dep) == "2020(1)"] <- "2020"
kable(head(dep, 3))
dep <- dep %>%
mutate(across("2012":"2021", as.integer))
dep
library(readxl)
library(knitr)
library(dplyr)
library(tidyr)
# install.packages("writexl")
library(writexl)
dep <- readxl::read_excel("term_project/Number of Departing Visitors by Country of Residence.xls", skip = 4)
glimpse(dep)
dep <- head(dep, - 15)
dep <- dep %>%
separate(Nationality, c(NA,"Nationality")," - ")
names(dep)[names(dep) == "2020(1)"] <- "2020"
kable(head(dep, 3))
dep <- dep %>%
mutate(across("2012":"2021", as.integer))
melted_dep <- melt(dep, "Nationality")
library(readxl)
library(knitr)
library(dplyr)
library(tidyr)
library(reshape2)
# install.packages("writexl")
library(writexl)
dep <- readxl::read_excel("term_project/Number of Departing Visitors by Country of Residence.xls", skip = 4)
glimpse(dep)
dep <- head(dep, - 15)
dep <- dep %>%
separate(Nationality, c(NA,"Nationality")," - ")
names(dep)[names(dep) == "2020(1)"] <- "2020"
kable(head(dep, 3))
dep <- dep %>%
mutate(across("2012":"2021", as.integer))
melted_dep <- melt(dep, "Nationality")
melted_dep
dep <- dep %>%
mutate(across("2012":"2021", as.integer))
write_xlsx(dep,"term_project/depart_by_residence.xlsx")
melted_dep <- melt(dep, "Nationality")
colnames(melted_dep) <- c('Nationality','Dep_Year','Departing_Visitors')
write_xlsx(melted_dep,"term_project/melted_depart_by_residence.xlsx")
glimpse(dep)
glimpse(melted_dep)
melted_dep[, 2] <- sapply(melted_dep[,2],as.integer)
glimpse(melted_dep)
melted_dep
library(readxl)
library(knitr)
library(dplyr)
library(tidyr)
library(reshape2)
# install.packages("writexl")
library(writexl)
dep <- readxl::read_excel("term_project/Number of Departing Visitors by Country of Residence.xls", skip = 4)
glimpse(dep)
dep <- head(dep, - 15)
dep <- dep %>%
separate(Nationality, c(NA,"Nationality")," - ")
names(dep)[names(dep) == "2020(1)"] <- "2020"
kable(head(dep, 3))
dep <- dep %>%
mutate(across("2012":"2021", as.integer))
write_xlsx(dep,"term_project/depart_by_residence.xlsx")
melted_dep <- melt(dep, "Nationality")
colnames(melted_dep) <- c('Nationality','Dep_Year','Departing_Visitors')
write_xlsx(melted_dep,"term_project/melted_depart_by_residence.xlsx")
glimpse(melted_dep)
purp <- readxl::read_excel("term_project/Foreign and Citizen Visitors by Purpose of Visit (Foreigner and Citizens Resident Abroad).xls", skip = 5)
purp <- head(purp, -9)
colnames(purp)[1:5]
names(purp)[3:23] <- sub(".*?\n", "", names(purp)[3:23])
names(purp) <- gsub(r"{\s*\([^\)]+\)}","",names(purp))
names(purp) <- trimws(names(purp), "l")
names(purp) <- gsub(" / ", "_", names(purp))
names(purp) <- gsub(" ", "_", names(purp))
names(purp)[3:7] <- substr(names(purp)[3:7],1,nchar(names(purp)[3:7])-4)
names(purp)[8:23] <- substr(names(purp)[8:23],1,nchar(names(purp)[8:23])-5)
names(purp) <- gsub(",", "", names(purp))
purp <- subset(purp, select = -c(Yıl,Çeyrek))
purp <- purp[,-11]
names(purp)[1:5]
names(purp)[1:10] <- paste0("ALL_", names(purp)[1:10])
names(purp)[11:20] <- paste0("TR_", names(purp)[11:20])
purp <- purp %>% select(Year, Quarter, ALL_Total:TR_Other)
glimpse(purp)
kable(head(purp))
purp <- purp %>% fill(Year)
purp$TR_Transit <- 0
kable(filter(purp, rowSums(is.na(purp)) > 0 | (Year == 2020 & Quarter == "II")))
purp <- data.frame(lapply(purp, gsub, pattern = "-", replacement = 0))
purp[is.na(purp)] <- 0
purp[,-2] <- sapply(purp[,-2],as.integer)
write_xlsx(purp,"term_project/purposes.xlsx")
glimpse(purp)
night <- readxl::read_excel("term_project/Tourism Income, Expenditure and Average Number of Nights.xls", skip = 4)
night <- head(night, -9)
colnames(night)
night <- night[,-7]
names(night) <- sub(".*?\n", "", names(night))
colnames(night)[2] <- "Quarter"
colnames(night)[3] <- "Tourism_Income_in_ThousandDollars"
colnames(night)[4] <- "Number_of_Departing_Visitors"
colnames(night)[5] <- "ALL_Average_expenditure_per_capita_in_Dollars"
colnames(night)[6] <- "ALL_Average_number_of_overnights"
colnames(night)[7] <- "Tourism_expenditure_in_ThousandDollars"
colnames(night)[8] <- "Number_of_Turkish_citizens_visited_abroad"
colnames(night)[9] <- "TR_Average_expenditure_per_capita_in_Dollars"
colnames(night)[10] <- "TR_Average_number_of_overnights"
names(night)
kable(tail(night))
night <- night %>% fill(Year)
night$Quarter[night$Quarter == "Yıllık-Annual"] <- "Anual"
night <- data.frame(lapply(night, gsub, pattern = "-", replacement = 0))
night[is.na(night)] <- 0
night[,-2] <- sapply(night[,-2],as.numeric)
night[, 1] <- sapply(night[,1],as.integer)
night[, 4] <- sapply(night[,4],as.integer)
night[, 8] <- sapply(night[,8],as.integer)
write_xlsx(night,"term_project/income_nights.xlsx")
kable(head(night))
mon <- readxl::read_excel("term_project/Tourism income, number of visitors and average expenditure per capita by months.xls", skip = 4)
mon <- head(mon, -9)
colnames(mon)[1:7]
names(mon)[1] <- "Months"
names(mon)[c(2,5,8,11,14,17,20,23,26,29,32)] <- "Tourism_Income_in_ThousandDollars"
names(mon)[c(3,6,9,12,15,18,21,24,27,30,33)] <- "Number_of_Visitors"
names(mon)[c(4,7,10,13,16,19,22,25,28,31,34)] <- "Average_expenditure_per_capita"
names(mon)[2:4] <- paste0(names(mon)[2:4], "_2012")
names(mon)[5:7] <- paste0(names(mon)[5:7], "_2013")
names(mon)[8:10] <- paste0(names(mon)[8:10], "_2014")
names(mon)[11:13] <- paste0(names(mon)[11:13], "_2015")
names(mon)[14:16] <- paste0(names(mon)[14:16], "_2016")
names(mon)[17:19] <- paste0(names(mon)[17:19], "_2017")
names(mon)[20:22] <- paste0(names(mon)[20:22], "_2018")
names(mon)[23:25] <- paste0(names(mon)[23:25], "_2019")
names(mon)[26:28] <- paste0(names(mon)[26:28], "_2020")
names(mon)[29:31] <- paste0(names(mon)[29:31], "_2021")
names(mon)[32:34] <- paste0(names(mon)[32:34], "_2022")
names(mon)[1:7]
mon <- mon %>%
separate(Months, c(NA,"Months")," - ")
mon <- data.frame(lapply(mon, gsub, pattern = "-", replacement = 0))
mon[is.na(mon)] <- 0
mon[,-1] <- sapply(mon[,-1],as.numeric)
mon[,grepl("Number_of_Visitors",names(mon))]<-sapply(mon[,grepl("Number_of_Visitors", names(mon))],as.integer)
write_xlsx(mon,"term_project/income_months.xlsx")
kable(head(mon))
library(readxl)
library(knitr)
library(dplyr)
library(tidyr)
library(reshape2)
# install.packages("writexl")
library(writexl)
dep <- readxl::read_excel("term_project/Number of Departing Visitors by Country of Residence.xls", skip = 4)
glimpse(dep)
dep <- head(dep, - 15)
dep <- dep %>%
separate(Nationality, c(NA,"Nationality")," - ")
names(dep)[names(dep) == "2020(1)"] <- "2020"
kable(head(dep, 3))
dep <- dep %>%
mutate(across("2012":"2021", as.integer))
write_xlsx(dep,"term_project/depart_by_residence.xlsx")
melted_dep <- melt(dep, "Nationality")
colnames(melted_dep) <- c('Nationality','Dep_Year','Departing_Visitors')
write_xlsx(melted_dep,"term_project/melted_depart_by_residence.xlsx")
glimpse(dep)
purp <- readxl::read_excel("term_project/Foreign and Citizen Visitors by Purpose of Visit (Foreigner and Citizens Resident Abroad).xls", skip = 5)
purp <- head(purp, -9)
colnames(purp)[1:5]
names(purp)[3:23] <- sub(".*?\n", "", names(purp)[3:23])
names(purp) <- gsub(r"{\s*\([^\)]+\)}","",names(purp))
names(purp) <- trimws(names(purp), "l")
names(purp) <- gsub(" / ", "_", names(purp))
names(purp) <- gsub(" ", "_", names(purp))
names(purp)[3:7] <- substr(names(purp)[3:7],1,nchar(names(purp)[3:7])-4)
names(purp)[8:23] <- substr(names(purp)[8:23],1,nchar(names(purp)[8:23])-5)
names(purp) <- gsub(",", "", names(purp))
purp <- subset(purp, select = -c(Yıl,Çeyrek))
purp <- purp[,-11]
names(purp)[1:5]
names(purp)[1:10] <- paste0("ALL_", names(purp)[1:10])
names(purp)[11:20] <- paste0("TR_", names(purp)[11:20])
purp <- purp %>% select(Year, Quarter, ALL_Total:TR_Other)
glimpse(purp)
kable(head(purp))
purp <- purp %>% fill(Year)
purp$TR_Transit <- 0
kable(filter(purp, rowSums(is.na(purp)) > 0 | (Year == 2020 & Quarter == "II")))
purp <- data.frame(lapply(purp, gsub, pattern = "-", replacement = 0))
purp[is.na(purp)] <- 0
purp[,-2] <- sapply(purp[,-2],as.integer)
write_xlsx(purp,"term_project/purposes.xlsx")
glimpse(purp)
night <- readxl::read_excel("term_project/Tourism Income, Expenditure and Average Number of Nights.xls", skip = 4)
night <- head(night, -9)
colnames(night)
night <- night[,-7]
names(night) <- sub(".*?\n", "", names(night))
colnames(night)[2] <- "Quarter"
colnames(night)[3] <- "Tourism_Income_in_ThousandDollars"
colnames(night)[4] <- "Number_of_Departing_Visitors"
colnames(night)[5] <- "ALL_Average_expenditure_per_capita_in_Dollars"
colnames(night)[6] <- "ALL_Average_number_of_overnights"
colnames(night)[7] <- "Tourism_expenditure_in_ThousandDollars"
colnames(night)[8] <- "Number_of_Turkish_citizens_visited_abroad"
colnames(night)[9] <- "TR_Average_expenditure_per_capita_in_Dollars"
colnames(night)[10] <- "TR_Average_number_of_overnights"
names(night)
kable(tail(night))
night <- night %>% fill(Year)
night$Quarter[night$Quarter == "Yıllık-Annual"] <- "Anual"
night <- data.frame(lapply(night, gsub, pattern = "-", replacement = 0))
night[is.na(night)] <- 0
night[,-2] <- sapply(night[,-2],as.numeric)
night[, 1] <- sapply(night[,1],as.integer)
night[, 4] <- sapply(night[,4],as.integer)
night[, 8] <- sapply(night[,8],as.integer)
write_xlsx(night,"term_project/income_nights.xlsx")
kable(head(night))
mon <- readxl::read_excel("term_project/Tourism income, number of visitors and average expenditure per capita by months.xls", skip = 4)
mon <- head(mon, -9)
colnames(mon)[1:7]
names(mon)[1] <- "Months"
names(mon)[c(2,5,8,11,14,17,20,23,26,29,32)] <- "Tourism_Income_in_ThousandDollars"
names(mon)[c(3,6,9,12,15,18,21,24,27,30,33)] <- "Number_of_Visitors"
names(mon)[c(4,7,10,13,16,19,22,25,28,31,34)] <- "Average_expenditure_per_capita"
names(mon)[2:4] <- paste0(names(mon)[2:4], "_2012")
names(mon)[5:7] <- paste0(names(mon)[5:7], "_2013")
names(mon)[8:10] <- paste0(names(mon)[8:10], "_2014")
names(mon)[11:13] <- paste0(names(mon)[11:13], "_2015")
names(mon)[14:16] <- paste0(names(mon)[14:16], "_2016")
names(mon)[17:19] <- paste0(names(mon)[17:19], "_2017")
names(mon)[20:22] <- paste0(names(mon)[20:22], "_2018")
names(mon)[23:25] <- paste0(names(mon)[23:25], "_2019")
names(mon)[26:28] <- paste0(names(mon)[26:28], "_2020")
names(mon)[29:31] <- paste0(names(mon)[29:31], "_2021")
names(mon)[32:34] <- paste0(names(mon)[32:34], "_2022")
names(mon)[1:7]
mon <- mon %>%
separate(Months, c(NA,"Months")," - ")
mon <- data.frame(lapply(mon, gsub, pattern = "-", replacement = 0))
mon[is.na(mon)] <- 0
mon[,-1] <- sapply(mon[,-1],as.numeric)
mon[,grepl("Number_of_Visitors",names(mon))]<-sapply(mon[,grepl("Number_of_Visitors", names(mon))],as.integer)
write_xlsx(mon,"term_project/income_months.xlsx")
kable(head(mon))
