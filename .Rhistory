mon[,-1] <- sapply(mon[,-1],as.numeric)
mon[,grepl("Number_of_Visitors",names(mon))]<-sapply(mon[,grepl("Number_of_Visitors", names(mon))],as.integer)
write_xlsx(mon,"term_project/income_months.xslx")
kable(head(mon))
library(readxl)
library(knitr)
library(ggplot2)
library(dplyr)
library(tidyr)
library(scales)
# install.packages("writexl")
library(writexl)
dep <- readxl::read_excel("term_project/Number of Departing Visitors by Country of Residence.xls", skip = 4)
glimpse(dep)
dep <- head(dep, - 15)
dep <- dep %>%
separate(Nationality, c(NA,"Nationality")," - ")
names(dep)[names(dep) == "2020(1)"] <- "2020"
kable(head(dep, 3))
dep <- dep %>%
mutate(across("2012":"2021", as.integer))
write_xlsx(dep,"term_project/depart_by_residence.xlsx")
glimpse(dep)
purp <- readxl::read_excel("term_project/Foreign and Citizen Visitors by Purpose of Visit (Foreigner and Citizens Resident Abroad).xls", skip = 5)
purp <- head(purp, -9)
colnames(purp)[1:5]
names(purp)[3:23] <- sub(".*?\n", "", names(purp)[3:23])
names(purp) <- gsub(r"{\s*\([^\)]+\)}","",names(purp))
names(purp) <- trimws(names(purp), "l")
names(purp) <- gsub(" / ", "_", names(purp))
names(purp) <- gsub(" ", "_", names(purp))
names(purp)[3:7] <- substr(names(purp)[3:7],1,nchar(names(purp)[3:7])-4)
names(purp)[8:23] <- substr(names(purp)[8:23],1,nchar(names(purp)[8:23])-5)
names(purp) <- gsub(",", "", names(purp))
purp <- subset(purp, select = -c(Yıl,Çeyrek))
purp <- purp[,-11]
names(purp)[1:5]
names(purp)[1:10] <- paste0("ALL_", names(purp)[1:10])
names(purp)[11:20] <- paste0("TR_", names(purp)[11:20])
purp <- purp %>% select(Year, Quarter, ALL_Total:TR_Other)
glimpse(purp)
kable(head(purp))
purp <- purp %>% fill(Year)
purp$TR_Transit <- 0
kable(filter(purp, rowSums(is.na(purp)) > 0 | (Year == 2020 & Quarter == "II")))
purp <- data.frame(lapply(purp, gsub, pattern = "-", replacement = 0))
purp[is.na(purp)] <- 0
purp[,-2] <- sapply(purp[,-2],as.integer)
write_xlsx(purp,"term_project/purposes.xlsx")
glimpse(purp)
night <- readxl::read_excel("term_project/Tourism Income, Expenditure and Average Number of Nights.xls", skip = 4)
night <- head(night, -9)
colnames(night)
night <- night[,-7]
names(night) <- sub(".*?\n", "", names(night))
colnames(night)[2] <- "Quarter"
colnames(night)[3] <- "Tourism_Income_in_ThousandDollars"
colnames(night)[4] <- "Number_of_Departing_Visitors"
colnames(night)[5] <- "ALL_Average_expenditure_per_capita_in_Dollars"
colnames(night)[6] <- "ALL_Average_number_of_overnights"
colnames(night)[7] <- "Tourism_expenditure_in_ThousandDollars"
colnames(night)[8] <- "Number_of_Turkish_citizens_visited_abroad"
colnames(night)[9] <- "TR_Average_expenditure_per_capita_in_Dollars"
colnames(night)[10] <- "TR_Average_number_of_overnights"
names(night)
kable(tail(night))
night <- night %>% fill(Year)
night$Quarter[night$Quarter == "Yıllık-Annual"] <- "Anual"
night <- data.frame(lapply(night, gsub, pattern = "-", replacement = 0))
night[is.na(night)] <- 0
night[,-2] <- sapply(night[,-2],as.numeric)
night[, 1] <- sapply(night[,1],as.integer)
night[, 4] <- sapply(night[,4],as.integer)
night[, 8] <- sapply(night[,8],as.integer)
write_xlsx(night,"term_project/income_nights.xlsx")
kable(head(night))
mon <- readxl::read_excel("term_project/Tourism income, number of visitors and average expenditure per capita by months.xls", skip = 4)
mon <- head(mon, -9)
colnames(mon)[1:7]
names(mon)[1] <- "Months"
names(mon)[c(2,5,8,11,14,17,20,23,26,29,32)] <- "Tourism_Income_in_ThousandDollars"
names(mon)[c(3,6,9,12,15,18,21,24,27,30,33)] <- "Number_of_Visitors"
names(mon)[c(4,7,10,13,16,19,22,25,28,31,34)] <- "Average_expenditure_per_capita"
names(mon)[2:4] <- paste0(names(mon)[2:4], "_2012")
names(mon)[5:7] <- paste0(names(mon)[5:7], "_2013")
names(mon)[8:10] <- paste0(names(mon)[8:10], "_2014")
names(mon)[11:13] <- paste0(names(mon)[11:13], "_2015")
names(mon)[14:16] <- paste0(names(mon)[14:16], "_2016")
names(mon)[17:19] <- paste0(names(mon)[17:19], "_2017")
names(mon)[20:22] <- paste0(names(mon)[20:22], "_2018")
names(mon)[23:25] <- paste0(names(mon)[23:25], "_2019")
names(mon)[26:28] <- paste0(names(mon)[26:28], "_2020")
names(mon)[29:31] <- paste0(names(mon)[29:31], "_2021")
names(mon)[32:34] <- paste0(names(mon)[32:34], "_2022")
names(mon)[1:7]
mon <- mon %>%
separate(Months, c(NA,"Months")," - ")
mon <- data.frame(lapply(mon, gsub, pattern = "-", replacement = 0))
mon[is.na(mon)] <- 0
mon[,-1] <- sapply(mon[,-1],as.numeric)
mon[,grepl("Number_of_Visitors",names(mon))]<-sapply(mon[,grepl("Number_of_Visitors", names(mon))],as.integer)
write_xlsx(mon,"term_project/income_months.xlsx")
kable(head(mon))
night$Quarter[night$Quarter == "Yıllık(1) 0 Annual"] <- "Anual"
night
library(readxl)
library(knitr)
library(ggplot2)
library(dplyr)
library(tidyr)
library(scales)
# install.packages("writexl")
library(writexl)
dep <- readxl::read_excel("term_project/Number of Departing Visitors by Country of Residence.xls", skip = 4)
glimpse(dep)
dep <- head(dep, - 15)
dep <- dep %>%
separate(Nationality, c(NA,"Nationality")," - ")
names(dep)[names(dep) == "2020(1)"] <- "2020"
kable(head(dep, 3))
dep <- dep %>%
mutate(across("2012":"2021", as.integer))
write_xlsx(dep,"term_project/depart_by_residence.xlsx")
glimpse(dep)
purp <- readxl::read_excel("term_project/Foreign and Citizen Visitors by Purpose of Visit (Foreigner and Citizens Resident Abroad).xls", skip = 5)
purp <- head(purp, -9)
colnames(purp)[1:5]
names(purp)[3:23] <- sub(".*?\n", "", names(purp)[3:23])
names(purp) <- gsub(r"{\s*\([^\)]+\)}","",names(purp))
names(purp) <- trimws(names(purp), "l")
names(purp) <- gsub(" / ", "_", names(purp))
names(purp) <- gsub(" ", "_", names(purp))
names(purp)[3:7] <- substr(names(purp)[3:7],1,nchar(names(purp)[3:7])-4)
names(purp)[8:23] <- substr(names(purp)[8:23],1,nchar(names(purp)[8:23])-5)
names(purp) <- gsub(",", "", names(purp))
purp <- subset(purp, select = -c(Yıl,Çeyrek))
purp <- purp[,-11]
names(purp)[1:5]
names(purp)[1:10] <- paste0("ALL_", names(purp)[1:10])
names(purp)[11:20] <- paste0("TR_", names(purp)[11:20])
purp <- purp %>% select(Year, Quarter, ALL_Total:TR_Other)
glimpse(purp)
kable(head(purp))
purp <- purp %>% fill(Year)
purp$TR_Transit <- 0
kable(filter(purp, rowSums(is.na(purp)) > 0 | (Year == 2020 & Quarter == "II")))
purp <- data.frame(lapply(purp, gsub, pattern = "-", replacement = 0))
purp[is.na(purp)] <- 0
purp[,-2] <- sapply(purp[,-2],as.integer)
write_xlsx(purp,"term_project/purposes.xlsx")
glimpse(purp)
night <- readxl::read_excel("term_project/Tourism Income, Expenditure and Average Number of Nights.xls", skip = 4)
night <- head(night, -9)
colnames(night)
night <- night[,-7]
names(night) <- sub(".*?\n", "", names(night))
colnames(night)[2] <- "Quarter"
colnames(night)[3] <- "Tourism_Income_in_ThousandDollars"
colnames(night)[4] <- "Number_of_Departing_Visitors"
colnames(night)[5] <- "ALL_Average_expenditure_per_capita_in_Dollars"
colnames(night)[6] <- "ALL_Average_number_of_overnights"
colnames(night)[7] <- "Tourism_expenditure_in_ThousandDollars"
colnames(night)[8] <- "Number_of_Turkish_citizens_visited_abroad"
colnames(night)[9] <- "TR_Average_expenditure_per_capita_in_Dollars"
colnames(night)[10] <- "TR_Average_number_of_overnights"
names(night)
kable(tail(night))
night <- night %>% fill(Year)
night$Quarter[night$Quarter == "Yıllık-Annual"] <- "Anual"
night$Quarter[night$Quarter == "Yıllık(1) 0 Annual"] <- "Anual"
night <- data.frame(lapply(night, gsub, pattern = "-", replacement = 0))
night[is.na(night)] <- 0
night[,-2] <- sapply(night[,-2],as.numeric)
night[, 1] <- sapply(night[,1],as.integer)
night[, 4] <- sapply(night[,4],as.integer)
night[, 8] <- sapply(night[,8],as.integer)
write_xlsx(night,"term_project/income_nights.xlsx")
kable(head(night))
mon <- readxl::read_excel("term_project/Tourism income, number of visitors and average expenditure per capita by months.xls", skip = 4)
mon <- head(mon, -9)
colnames(mon)[1:7]
names(mon)[1] <- "Months"
names(mon)[c(2,5,8,11,14,17,20,23,26,29,32)] <- "Tourism_Income_in_ThousandDollars"
names(mon)[c(3,6,9,12,15,18,21,24,27,30,33)] <- "Number_of_Visitors"
names(mon)[c(4,7,10,13,16,19,22,25,28,31,34)] <- "Average_expenditure_per_capita"
names(mon)[2:4] <- paste0(names(mon)[2:4], "_2012")
names(mon)[5:7] <- paste0(names(mon)[5:7], "_2013")
names(mon)[8:10] <- paste0(names(mon)[8:10], "_2014")
names(mon)[11:13] <- paste0(names(mon)[11:13], "_2015")
names(mon)[14:16] <- paste0(names(mon)[14:16], "_2016")
names(mon)[17:19] <- paste0(names(mon)[17:19], "_2017")
names(mon)[20:22] <- paste0(names(mon)[20:22], "_2018")
names(mon)[23:25] <- paste0(names(mon)[23:25], "_2019")
names(mon)[26:28] <- paste0(names(mon)[26:28], "_2020")
names(mon)[29:31] <- paste0(names(mon)[29:31], "_2021")
names(mon)[32:34] <- paste0(names(mon)[32:34], "_2022")
names(mon)[1:7]
mon <- mon %>%
separate(Months, c(NA,"Months")," - ")
mon <- data.frame(lapply(mon, gsub, pattern = "-", replacement = 0))
mon[is.na(mon)] <- 0
mon[,-1] <- sapply(mon[,-1],as.numeric)
mon[,grepl("Number_of_Visitors",names(mon))]<-sapply(mon[,grepl("Number_of_Visitors", names(mon))],as.integer)
write_xlsx(mon,"term_project/income_months.xlsx")
kable(head(mon))
library(readxl)
library(knitr)
library(ggplot2)
library(dplyr)
library(tidyr)
library(scales)
# install.packages("writexl")
library(writexl)
dep <- readxl::read_excel("term_project/Number of Departing Visitors by Country of Residence.xls", skip = 4)
glimpse(dep)
dep <- head(dep, - 15)
dep <- dep %>%
separate(Nationality, c(NA,"Nationality")," - ")
names(dep)[names(dep) == "2020(1)"] <- "2020"
kable(head(dep, 3))
dep <- dep %>%
mutate(across("2012":"2021", as.integer))
write_xlsx(dep,"term_project/depart_by_residence.xlsx")
glimpse(dep)
purp <- readxl::read_excel("term_project/Foreign and Citizen Visitors by Purpose of Visit (Foreigner and Citizens Resident Abroad).xls", skip = 5)
purp <- head(purp, -9)
colnames(purp)[1:5]
names(purp)[3:23] <- sub(".*?\n", "", names(purp)[3:23])
names(purp) <- gsub(r"{\s*\([^\)]+\)}","",names(purp))
names(purp) <- trimws(names(purp), "l")
names(purp) <- gsub(" / ", "_", names(purp))
names(purp) <- gsub(" ", "_", names(purp))
names(purp)[3:7] <- substr(names(purp)[3:7],1,nchar(names(purp)[3:7])-4)
names(purp)[8:23] <- substr(names(purp)[8:23],1,nchar(names(purp)[8:23])-5)
names(purp) <- gsub(",", "", names(purp))
purp <- subset(purp, select = -c(Yıl,Çeyrek))
purp <- purp[,-11]
names(purp)[1:5]
names(purp)[1:10] <- paste0("ALL_", names(purp)[1:10])
names(purp)[11:20] <- paste0("TR_", names(purp)[11:20])
purp <- purp %>% select(Year, Quarter, ALL_Total:TR_Other)
glimpse(purp)
kable(head(purp))
purp <- purp %>% fill(Year)
purp$TR_Transit <- 0
kable(filter(purp, rowSums(is.na(purp)) > 0 | (Year == 2020 & Quarter == "II")))
purp <- data.frame(lapply(purp, gsub, pattern = "-", replacement = 0))
purp[is.na(purp)] <- 0
purp[,-2] <- sapply(purp[,-2],as.integer)
write_xlsx(purp,"term_project/purposes.xlsx")
glimpse(purp)
night <- readxl::read_excel("term_project/Tourism Income, Expenditure and Average Number of Nights.xls", skip = 4)
night <- head(night, -9)
colnames(night)
night <- night[,-7]
names(night) <- sub(".*?\n", "", names(night))
colnames(night)[2] <- "Quarter"
colnames(night)[3] <- "Tourism_Income_in_ThousandDollars"
colnames(night)[4] <- "Number_of_Departing_Visitors"
colnames(night)[5] <- "ALL_Average_expenditure_per_capita_in_Dollars"
colnames(night)[6] <- "ALL_Average_number_of_overnights"
colnames(night)[7] <- "Tourism_expenditure_in_ThousandDollars"
colnames(night)[8] <- "Number_of_Turkish_citizens_visited_abroad"
colnames(night)[9] <- "TR_Average_expenditure_per_capita_in_Dollars"
colnames(night)[10] <- "TR_Average_number_of_overnights"
names(night)
kable(tail(night))
night <- night %>% fill(Year)
night$Quarter[night$Quarter == "Yıllık-Annual"] <- "Anual"
night$Quarter[night$Quarter == "Yıllık(1) 0 Annual"] <- "Anual"
night <- data.frame(lapply(night, gsub, pattern = "-", replacement = 0))
night[is.na(night)] <- 0
night[,-2] <- sapply(night[,-2],as.numeric)
night[, 1] <- sapply(night[,1],as.integer)
night[, 4] <- sapply(night[,4],as.integer)
night[, 8] <- sapply(night[,8],as.integer)
write_xlsx(night,"term_project/income_nights.xlsx")
kable(head(night))
mon <- readxl::read_excel("term_project/Tourism income, number of visitors and average expenditure per capita by months.xls", skip = 4)
mon <- head(mon, -9)
colnames(mon)[1:7]
names(mon)[1] <- "Months"
names(mon)[c(2,5,8,11,14,17,20,23,26,29,32)] <- "Tourism_Income_in_ThousandDollars"
names(mon)[c(3,6,9,12,15,18,21,24,27,30,33)] <- "Number_of_Visitors"
names(mon)[c(4,7,10,13,16,19,22,25,28,31,34)] <- "Average_expenditure_per_capita"
names(mon)[2:4] <- paste0(names(mon)[2:4], "_2012")
names(mon)[5:7] <- paste0(names(mon)[5:7], "_2013")
names(mon)[8:10] <- paste0(names(mon)[8:10], "_2014")
names(mon)[11:13] <- paste0(names(mon)[11:13], "_2015")
names(mon)[14:16] <- paste0(names(mon)[14:16], "_2016")
names(mon)[17:19] <- paste0(names(mon)[17:19], "_2017")
names(mon)[20:22] <- paste0(names(mon)[20:22], "_2018")
names(mon)[23:25] <- paste0(names(mon)[23:25], "_2019")
names(mon)[26:28] <- paste0(names(mon)[26:28], "_2020")
names(mon)[29:31] <- paste0(names(mon)[29:31], "_2021")
names(mon)[32:34] <- paste0(names(mon)[32:34], "_2022")
names(mon)[1:7]
mon <- mon %>%
separate(Months, c(NA,"Months")," - ")
mon <- data.frame(lapply(mon, gsub, pattern = "-", replacement = 0))
mon[is.na(mon)] <- 0
mon[,-1] <- sapply(mon[,-1],as.numeric)
mon[,grepl("Number_of_Visitors",names(mon))]<-sapply(mon[,grepl("Number_of_Visitors", names(mon))],as.integer)
write_xlsx(mon,"term_project/income_months.xlsx")
kable(head(mon))
night$Quarter[night$Quarter == "Yıllık(1) - Annual"]
library(readxl)
library(knitr)
library(ggplot2)
library(dplyr)
library(tidyr)
library(scales)
# install.packages("writexl")
library(writexl)
dep <- readxl::read_excel("term_project/Number of Departing Visitors by Country of Residence.xls", skip = 4)
glimpse(dep)
dep <- head(dep, - 15)
dep <- dep %>%
separate(Nationality, c(NA,"Nationality")," - ")
names(dep)[names(dep) == "2020(1)"] <- "2020"
kable(head(dep, 3))
dep <- dep %>%
mutate(across("2012":"2021", as.integer))
write_xlsx(dep,"term_project/depart_by_residence.xlsx")
glimpse(dep)
purp <- readxl::read_excel("term_project/Foreign and Citizen Visitors by Purpose of Visit (Foreigner and Citizens Resident Abroad).xls", skip = 5)
purp <- head(purp, -9)
colnames(purp)[1:5]
names(purp)[3:23] <- sub(".*?\n", "", names(purp)[3:23])
names(purp) <- gsub(r"{\s*\([^\)]+\)}","",names(purp))
names(purp) <- trimws(names(purp), "l")
names(purp) <- gsub(" / ", "_", names(purp))
names(purp) <- gsub(" ", "_", names(purp))
names(purp)[3:7] <- substr(names(purp)[3:7],1,nchar(names(purp)[3:7])-4)
names(purp)[8:23] <- substr(names(purp)[8:23],1,nchar(names(purp)[8:23])-5)
names(purp) <- gsub(",", "", names(purp))
purp <- subset(purp, select = -c(Yıl,Çeyrek))
purp <- purp[,-11]
names(purp)[1:5]
names(purp)[1:10] <- paste0("ALL_", names(purp)[1:10])
names(purp)[11:20] <- paste0("TR_", names(purp)[11:20])
purp <- purp %>% select(Year, Quarter, ALL_Total:TR_Other)
glimpse(purp)
kable(head(purp))
purp <- purp %>% fill(Year)
purp$TR_Transit <- 0
kable(filter(purp, rowSums(is.na(purp)) > 0 | (Year == 2020 & Quarter == "II")))
purp <- data.frame(lapply(purp, gsub, pattern = "-", replacement = 0))
purp[is.na(purp)] <- 0
purp[,-2] <- sapply(purp[,-2],as.integer)
write_xlsx(purp,"term_project/purposes.xlsx")
glimpse(purp)
night <- readxl::read_excel("term_project/Tourism Income, Expenditure and Average Number of Nights.xls", skip = 4)
night <- head(night, -9)
colnames(night)
night <- night[,-7]
names(night) <- sub(".*?\n", "", names(night))
colnames(night)[2] <- "Quarter"
colnames(night)[3] <- "Tourism_Income_in_ThousandDollars"
colnames(night)[4] <- "Number_of_Departing_Visitors"
colnames(night)[5] <- "ALL_Average_expenditure_per_capita_in_Dollars"
colnames(night)[6] <- "ALL_Average_number_of_overnights"
colnames(night)[7] <- "Tourism_expenditure_in_ThousandDollars"
colnames(night)[8] <- "Number_of_Turkish_citizens_visited_abroad"
colnames(night)[9] <- "TR_Average_expenditure_per_capita_in_Dollars"
colnames(night)[10] <- "TR_Average_number_of_overnights"
names(night)
kable(tail(night))
night <- night %>% fill(Year)
night$Quarter[night$Quarter == "Yıllık-Annual"] <- "Anual"
night$Quarter[night$Quarter == "Yıllık(1) - Annual"] <- "Anual"
night <- data.frame(lapply(night, gsub, pattern = "-", replacement = 0))
night[is.na(night)] <- 0
night[,-2] <- sapply(night[,-2],as.numeric)
night[, 1] <- sapply(night[,1],as.integer)
night[, 4] <- sapply(night[,4],as.integer)
night[, 8] <- sapply(night[,8],as.integer)
write_xlsx(night,"term_project/income_nights.xlsx")
kable(head(night))
mon <- readxl::read_excel("term_project/Tourism income, number of visitors and average expenditure per capita by months.xls", skip = 4)
mon <- head(mon, -9)
colnames(mon)[1:7]
names(mon)[1] <- "Months"
names(mon)[c(2,5,8,11,14,17,20,23,26,29,32)] <- "Tourism_Income_in_ThousandDollars"
names(mon)[c(3,6,9,12,15,18,21,24,27,30,33)] <- "Number_of_Visitors"
names(mon)[c(4,7,10,13,16,19,22,25,28,31,34)] <- "Average_expenditure_per_capita"
names(mon)[2:4] <- paste0(names(mon)[2:4], "_2012")
names(mon)[5:7] <- paste0(names(mon)[5:7], "_2013")
names(mon)[8:10] <- paste0(names(mon)[8:10], "_2014")
names(mon)[11:13] <- paste0(names(mon)[11:13], "_2015")
names(mon)[14:16] <- paste0(names(mon)[14:16], "_2016")
names(mon)[17:19] <- paste0(names(mon)[17:19], "_2017")
names(mon)[20:22] <- paste0(names(mon)[20:22], "_2018")
names(mon)[23:25] <- paste0(names(mon)[23:25], "_2019")
names(mon)[26:28] <- paste0(names(mon)[26:28], "_2020")
names(mon)[29:31] <- paste0(names(mon)[29:31], "_2021")
names(mon)[32:34] <- paste0(names(mon)[32:34], "_2022")
names(mon)[1:7]
mon <- mon %>%
separate(Months, c(NA,"Months")," - ")
mon <- data.frame(lapply(mon, gsub, pattern = "-", replacement = 0))
mon[is.na(mon)] <- 0
mon[,-1] <- sapply(mon[,-1],as.numeric)
mon[,grepl("Number_of_Visitors",names(mon))]<-sapply(mon[,grepl("Number_of_Visitors", names(mon))],as.integer)
write_xlsx(mon,"term_project/income_months.xlsx")
kable(head(mon))
mon
library(reshape)
library("reshape")
library(reshape2)
mon
melt(mon, id = c("Months"))
mon
melt(mon, id = c("Months"))
library(readxl)
library(knitr)
library(dplyr)
library(tidyr)
# install.packages("writexl")
library(writexl)
dep <- readxl::read_excel("term_project/Number of Departing Visitors by Country of Residence.xls", skip = 4)
glimpse(dep)
dep <- head(dep, - 15)
dep <- dep %>%
separate(Nationality, c(NA,"Nationality")," - ")
names(dep)[names(dep) == "2020(1)"] <- "2020"
kable(head(dep, 3))
dep <- dep %>%
mutate(across("2012":"2021", as.integer))
write_xlsx(dep,"term_project/depart_by_residence.xlsx")
glimpse(dep)
purp <- readxl::read_excel("term_project/Foreign and Citizen Visitors by Purpose of Visit (Foreigner and Citizens Resident Abroad).xls", skip = 5)
purp <- head(purp, -9)
colnames(purp)[1:5]
names(purp)[3:23] <- sub(".*?\n", "", names(purp)[3:23])
names(purp) <- gsub(r"{\s*\([^\)]+\)}","",names(purp))
names(purp) <- trimws(names(purp), "l")
names(purp) <- gsub(" / ", "_", names(purp))
names(purp) <- gsub(" ", "_", names(purp))
names(purp)[3:7] <- substr(names(purp)[3:7],1,nchar(names(purp)[3:7])-4)
names(purp)[8:23] <- substr(names(purp)[8:23],1,nchar(names(purp)[8:23])-5)
names(purp) <- gsub(",", "", names(purp))
purp <- subset(purp, select = -c(Yıl,Çeyrek))
purp <- purp[,-11]
names(purp)[1:5]
names(purp)[1:10] <- paste0("ALL_", names(purp)[1:10])
names(purp)[11:20] <- paste0("TR_", names(purp)[11:20])
purp <- purp %>% select(Year, Quarter, ALL_Total:TR_Other)
glimpse(purp)
kable(head(purp))
purp <- purp %>% fill(Year)
purp$TR_Transit <- 0
kable(filter(purp, rowSums(is.na(purp)) > 0 | (Year == 2020 & Quarter == "II")))
purp <- data.frame(lapply(purp, gsub, pattern = "-", replacement = 0))
purp[is.na(purp)] <- 0
purp[,-2] <- sapply(purp[,-2],as.integer)
write_xlsx(purp,"term_project/purposes.xlsx")
glimpse(purp)
night <- readxl::read_excel("term_project/Tourism Income, Expenditure and Average Number of Nights.xls", skip = 4)
night <- head(night, -9)
colnames(night)
night <- night[,-7]
names(night) <- sub(".*?\n", "", names(night))
colnames(night)[2] <- "Quarter"
colnames(night)[3] <- "Tourism_Income_in_ThousandDollars"
colnames(night)[4] <- "Number_of_Departing_Visitors"
colnames(night)[5] <- "ALL_Average_expenditure_per_capita_in_Dollars"
colnames(night)[6] <- "ALL_Average_number_of_overnights"
colnames(night)[7] <- "Tourism_expenditure_in_ThousandDollars"
colnames(night)[8] <- "Number_of_Turkish_citizens_visited_abroad"
colnames(night)[9] <- "TR_Average_expenditure_per_capita_in_Dollars"
colnames(night)[10] <- "TR_Average_number_of_overnights"
names(night)
kable(tail(night))
night <- night %>% fill(Year)
night$Quarter[night$Quarter == "Yıllık-Annual"] <- "Anual"
night$Quarter[night$Quarter == "Yıllık(1) - Annual"] <- "Anual"
night <- data.frame(lapply(night, gsub, pattern = "-", replacement = 0))
night[is.na(night)] <- 0
night[,-2] <- sapply(night[,-2],as.numeric)
night[, 1] <- sapply(night[,1],as.integer)
night[, 4] <- sapply(night[,4],as.integer)
night[, 8] <- sapply(night[,8],as.integer)
write_xlsx(night,"term_project/income_nights.xlsx")
kable(head(night))
mon <- readxl::read_excel("term_project/Tourism income, number of visitors and average expenditure per capita by months.xls", skip = 4)
mon <- head(mon, -9)
colnames(mon)[1:7]
names(mon)[1] <- "Months"
names(mon)[c(2,5,8,11,14,17,20,23,26,29,32)] <- "Tourism_Income_in_ThousandDollars"
names(mon)[c(3,6,9,12,15,18,21,24,27,30,33)] <- "Number_of_Visitors"
names(mon)[c(4,7,10,13,16,19,22,25,28,31,34)] <- "Average_expenditure_per_capita"
names(mon)[2:4] <- paste0(names(mon)[2:4], "_2012")
names(mon)[5:7] <- paste0(names(mon)[5:7], "_2013")
names(mon)[8:10] <- paste0(names(mon)[8:10], "_2014")
names(mon)[11:13] <- paste0(names(mon)[11:13], "_2015")
names(mon)[14:16] <- paste0(names(mon)[14:16], "_2016")
names(mon)[17:19] <- paste0(names(mon)[17:19], "_2017")
names(mon)[20:22] <- paste0(names(mon)[20:22], "_2018")
names(mon)[23:25] <- paste0(names(mon)[23:25], "_2019")
names(mon)[26:28] <- paste0(names(mon)[26:28], "_2020")
names(mon)[29:31] <- paste0(names(mon)[29:31], "_2021")
names(mon)[32:34] <- paste0(names(mon)[32:34], "_2022")
names(mon)[1:7]
mon <- mon %>%
separate(Months, c(NA,"Months")," - ")
mon <- data.frame(lapply(mon, gsub, pattern = "-", replacement = 0))
mon[is.na(mon)] <- 0
mon[,-1] <- sapply(mon[,-1],as.numeric)
mon[,grepl("Number_of_Visitors",names(mon))]<-sapply(mon[,grepl("Number_of_Visitors", names(mon))],as.integer)
write_xlsx(mon,"term_project/income_months.xlsx")
kable(head(mon))
